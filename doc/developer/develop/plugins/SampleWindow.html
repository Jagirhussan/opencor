<!DOCTYPE html>
<html>
    <head>
        <title>
            SampleWindow Plugin
        </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>

        <link href="../../../3rdparty/googleCodePrettify/prettify.css" rel="stylesheet" type="text/css"/>
        <link href="../../res/stylesheet.css" rel="stylesheet" type="text/css"/>

        <script src="../../../3rdparty/googleCodePrettify/prettify.js" type="text/javascript"></script>
        <script src="../../../3rdparty/jQuery/jquery.js" type="text/javascript"></script>
        <script src="../../../res/common.js" type="text/javascript"></script>
        <script src="../../res/menu.js" type="text/javascript"></script>
    </head>
    <body onload="prettyPrint()">
        <script type="text/javascript">
            headerAndContentsMenu("SampleWindow Plugin", "../../..");
        </script>

        <p>
            The purpose of this plugin is to extend our <a href="Sample.html">Sample</a> plugin by making it possible for the user to add two numbers through a dockable window.
        </p>

        <div class="section">
            Prerequisites
        </div>

        <ul>
            <li><a href="Sample.html">Sample</a> plugin</li>
        </ul>

        <div class="section">
            File structure
        </div>

        <pre><a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/i18n">i18n</a>
 &#9492;&#9472; <a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/i18n/SampleWindow_fr.ts">SampleWindow_fr.ts</a>
<a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/res">res</a>
 &#9492;&#9472; <a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/res/SampleWindow.qrc">SampleWindow.qrc</a>
<a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/src">src</a>
 &#9500;&#9472; <a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.cpp">samplewindowplugin.cpp</a>
 &#9500;&#9472; <a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.h">samplewindowplugin.h</a>
 &#9500;&#9472; <a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.json">samplewindowplugin.json</a>
 &#9500;&#9472; <a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.cpp">samplewindowwindow.cpp</a>
 &#9500;&#9472; <a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.h">samplewindowwindow.h</a>
 &#9492;&#9472; <a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.ui">samplewindowwindow.ui</a>
<a href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/CMakeLists.txt">CMakeLists.txt</a></pre>

        <div class="section">
            Category
        </div>

        <p>
            Our plugin is part of the <code>Sample</code> category, which means that its code can be found under <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/"><code>[OpenCOR]/src/plugins/sample/SampleWindow/</code></a>.
        </p>

        <div class="section">
            Interfaces
        </div>

        <p>
            Unlike for the <a href="Sample.html">Sample</a> plugin, we want our plugin to interact with OpenCOR. This means that it needs to implement some interfaces (click <a href="index.html#Interfaces">here</a> for more information about interfaces).
        </p>

        <p>
            We want our plugin to be a dockable window, so we need to implement both the <a href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininterface.inl">plugin</a> and <a href="https://github.com/opencor/opencor/blob/master/src/plugins/windowinterface.inl">window</a> interfaces.
        </p>

        <div class="section">
            CMake project
        </div>

        <p>
            As for the <a href="Sample.html">Sample</a> plugin, our plugin has a <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/CMakeLists.txt"><code>CMakeLists.txt</code></a> file, which contents is:
        </p>

        <pre class="prettyprint linenums">PROJECT(SampleWindowPlugin)

# Add the plugin

ADD_PLUGIN(SampleWindow
    SOURCES
        <a href="https://github.com/opencor/opencor/blob/master/src/plugins/i18ninterface.cpp"><code>../../i18ninterface.cpp</code></a>
        <a href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininfo.cpp"><code>../../plugininfo.cpp</code></a>

        <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.cpp"><code>src/samplewindowplugin.cpp</code></a>
        <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.cpp"><code>src/samplewindowwindow.cpp</code></a>
    HEADERS_MOC
        <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.h"><code>src/samplewindowplugin.h</code></a>
        <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.h"><code>src/samplewindowwindow.h</code></a>
    UIS
        <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.ui"><code>src/samplewindowwindow.ui</code></a>
    INCLUDE_DIRS
        src
    PLUGINS
        Core
        Sample
    QT_MODULES
        Widgets
    QT_LIBRARIES
        QtCore
        QtGui
        QtNetwork
        QtWidgets
        QtXmlPatterns
)</pre>

        <p>
            One of the interfaces our plugin implements comes with a <code>.cpp</code> file, so we reference it (line 7). Then, our plugin needs both the Core plugin and the <a href="Sample.html">Sample</a> plugin (to be able to use its <code>add()</code> function), so  they are referenced (lines 20-21) using the <code>PLUGINS</code> keyword (line 19). Finally, we reference the <a href="http://qt-project.org/">Qt</a> modules (line 23) and libraries (lines 25-27) needed by our plugin.
        </p>

        <div class="section">
            Plugin information
        </div>

        <p>
            Our <a href="index.html#Plugin%20information">plugin information</a> can be found in <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.cpp"><code>samplewindowplugin.cpp</code></a>, <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.h"><code>samplewindowplugin.h</code></a> and <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.json"><code>samplewindowplugin.json</code></a>. Starting with <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.h"><code>samplewindowplugin.h</code></a>, its contents is:
        </p>

        <pre class="prettyprint linenums:22">#ifndef SAMPLEWINDOWPLUGIN_H
#define SAMPLEWINDOWPLUGIN_H

//==============================================================================

#include "<a href="https://github.com/opencor/opencor/blob/master/src/plugins/i18ninterface.h"><code>i18ninterface.h</code></a>"
#include "<a href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininfo.h"><code>plugininfo.h</code></a>"
#include "<a href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininterface.h"><code>plugininterface.h</code></a>"
#include "<a href="https://github.com/opencor/opencor/blob/master/src/plugins/windowinterface.h"><code>windowinterface.h</code></a>"

//==============================================================================

namespace OpenCOR {
namespace SampleWindow {

//==============================================================================

PLUGININFO_FUNC SampleWindowPluginInfo();

//==============================================================================

class SampleWindowWindow;

//==============================================================================

class SampleWindowPlugin : public QObject, public I18nInterface,
                           public PluginInterface, public WindowInterface
{
    Q_OBJECT

    Q_PLUGIN_METADATA(IID "OpenCOR.SampleWindowPlugin" FILE "<a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.json"><code>samplewindowplugin.json</code></a>")

    Q_INTERFACES(OpenCOR::I18nInterface)
    Q_INTERFACES(OpenCOR::PluginInterface)
    Q_INTERFACES(OpenCOR::WindowInterface)

public:
#include "<a href="https://github.com/opencor/opencor/blob/master/src/plugins/i18ninterface.inl"><code>i18ninterface.inl</code></a>"
#include "<a href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininterface.inl"><code>plugininterface.inl</code></a>"
#include "<a href="https://github.com/opencor/opencor/blob/master/src/plugins/windowinterface.inl"><code>windowinterface.inl</code></a>"

private:
    QAction *mSampleWindowAction;

    SampleWindowWindow *mSampleWindowWindow;
};

//==============================================================================

}   // namespace SampleWindow
}   // namespace OpenCOR

//==============================================================================

#endif</pre>

        <p>
            As mentioned above, our plugin implements some interfaces, which means that their header file is included (lines 27 and 29-30). It also means that our plugin class inherits from those interfaces (lines 47-48), as well as make calls to the <code>Q_INTERFACES()</code> macro to let <a href-="http://qt-project.org/">Qt</a> know which interfaces it implements (lines 54-56). Finally, we include the inline files (lines 59-61) that declare various methods that must be implemented by our plugin class (see the <a href="#Interfaces%20implementation">next section</a>). (The rest of the class definition is specific to our plugin and is discussed <a href="#Plugin%20specific">below</a>.)
        </p>

        <p>
            The C function that is used by OpenCOR to retrieve some <a href="index.html#Basic%20information">basic information</a> about our plugin can be found in <a href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.cpp"><code>samplewindowplugin.cpp</code></a>:
        </p>

        <pre class="prettyprint linenums:38">PLUGININFO_FUNC SampleWindowPluginInfo()
{
    Descriptions descriptions;

    descriptions.insert("en", QString::fromUtf8("a plugin that provides a simple addition window."));
    descriptions.insert("fr", QString::fromUtf8("une extension qui fournit une simple fenêtre d'addition."));

    return new PluginInfo(PluginInfo::Sample, true, false,
                          QStringList() << "Core" << "Sample",
                          descriptions);
}</pre>

        <p>
            As can be seen, our plugin is selectable by the user, but it does not offer direct <a href="http://en.wikipedia.org/wiki/Command-line_interface">CLI</a> support (line 50). It also has a direct dependency on the Core <a href="Sample.html">Sample</a> plugins (line 51).
        </p>

        <script type="text/javascript">
            copyright("../../..");
        </script>
    </body>
</html>
