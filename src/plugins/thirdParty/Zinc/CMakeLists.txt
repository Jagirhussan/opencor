PROJECT(ZincPlugin)

# Retrieve the plugin's binary file(s)

STRING(REPLACE "${${CMAKE_PROJECT_NAME}_SOURCE_DIR}/" ""
      RELATIVE_PROJECT_SOURCE_DIR "${PROJECT_SOURCE_DIR}/${REMOTE_EXTERNAL_BINARIES_DIR}")

IF(WIN32)
#    IF(RELEASE_MODE)
#        RETRIEVE_BINARY_FILE(${RELATIVE_PROJECT_SOURCE_DIR} zinc.dll sha1value)
#        RETRIEVE_BINARY_FILE(${RELATIVE_PROJECT_SOURCE_DIR} zinc.lib sha1value)
#    ELSE()
#        RETRIEVE_BINARY_FILE(${RELATIVE_PROJECT_SOURCE_DIR} zinc.dll sha1value)
#        RETRIEVE_BINARY_FILE(${RELATIVE_PROJECT_SOURCE_DIR} zinc.lib sha1value)
#    ENDIF()
ELSEIF(APPLE)
   RETRIEVE_BINARY_FILE(${RELATIVE_PROJECT_SOURCE_DIR} libzinc.3.dylib 1791e262799fabcfaaaabf6d7d195d7075e682d3)
ELSE()
   RETRIEVE_BINARY_FILE(${RELATIVE_PROJECT_SOURCE_DIR} libzinc.so.3 3c5b62d12e4a396035e040f318e2c874a6952b56)
ENDIF()

# Retrieve the Zinc external binary

SET(EXTERNAL_BINARIES_DIR ${PROJECT_SOURCE_DIR}/${LOCAL_EXTERNAL_BINARIES_DIR})

IF(WIN32)
#    SET(EXTERNAL_BINARIES
#        zinc${CMAKE_SHARED_LIBRARY_SUFFIX}
#    )
ELSEIF(APPLE)
   SET(EXTERNAL_BINARIES
       libzinc.3${CMAKE_SHARED_LIBRARY_SUFFIX}
   )
ELSE()
    SET(EXTERNAL_BINARIES
        libzinc${CMAKE_SHARED_LIBRARY_SUFFIX}.3
    )
ENDIF()

# Add the plugin

ADD_PLUGIN(Zinc
    SOURCES
        ../../plugininfo.cpp

        src/zincplugin.cpp
    HEADERS_MOC
        src/zincplugin.h
    INCLUDE_DIRS
        include
        src
    QT_MODULES
        Core
    EXTERNAL_BINARIES_DIR
        ${EXTERNAL_BINARIES_DIR}
    EXTERNAL_BINARIES
        ${EXTERNAL_BINARIES}
    TESTS
        tests
)
